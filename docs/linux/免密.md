## ğŸ”§ å¿«é€Ÿä¿®å¤SSHå…å¯†ç™»å½•

### æ­¥éª¤1: ç”ŸæˆSSHå¯†é’¥(å¦‚æœè¿˜æ²¡æœ‰)

bash

```bash
# æ£€æŸ¥æ˜¯å¦å·²æœ‰å¯†é’¥
ls ~/.ssh/id_rsa.pub

# å¦‚æœæ²¡æœ‰,ç”Ÿæˆä¸€ä¸ª(ä¸€è·¯å›è½¦)
ssh-keygen -t rsa -b 4096
```

### æ­¥éª¤2: å¤åˆ¶å…¬é’¥åˆ°æ‰€æœ‰è™šæ‹Ÿæœº

bash

```bash
# å…ˆå¤åˆ¶åˆ°control-1
ssh-copy-id vagrant@192.168.56.11
# ä¼šæç¤ºè¾“å…¥å¯†ç ,é€šå¸¸æ˜¯: vagrant

# ç„¶åå¤åˆ¶åˆ°æ‰€æœ‰worker
ssh-copy-id vagrant@192.168.56.21
ssh-copy-id vagrant@192.168.56.22
ssh-copy-id vagrant@192.168.56.23
```

### æ­¥éª¤3: æµ‹è¯•å…å¯†ç™»å½•

bash

```bash
ssh vagrant@192.168.56.11 'echo "å…å¯†ç™»å½•æˆåŠŸ!"'
```

### æ­¥éª¤4: æµ‹è¯•sudo(å…å¯†sudoåº”è¯¥æ˜¯é»˜è®¤é…ç½®çš„)

bash

```bash
ssh vagrant@192.168.56.11 'sudo whoami'
```

åº”è¯¥è¾“å‡º `root`,ä¸éœ€è¦å¯†ç ã€‚

## æˆ‘æ¨èæ–¹æ¡ˆ2

æœ€ç®€å•çš„æ–¹å¼:

bash

```bash
# 1. é…ç½®SSHä½¿ç”¨Vagrantçš„å¯†é’¥
cat >> ~/.ssh/config << EOF
Host k8s-control-1
  HostName 192.168.56.11
  User vagrant
  IdentityFile /mnt/d/cai/k8s-cluster/vagrant/.vagrant/machines/control-1/virtualbox/private_key
  StrictHostKeyChecking no

Host k8s-worker-1
  HostName 192.168.56.21
  User vagrant
  IdentityFile /mnt/d/cai/k8s-cluster/vagrant/.vagrant/machines/worker-1/virtualbox/private_key
  StrictHostKeyChecking no

Host k8s-worker-2
  HostName 192.168.56.22
  User vagrant
  IdentityFile /mnt/d/cai/k8s-cluster/vagrant/.vagrant/machines/worker-2/virtualbox/private_key
  StrictHostKeyChecking no

Host k8s-worker-3
  HostName 192.168.56.23
  User vagrant
  IdentityFile /mnt/d/cai/k8s-cluster/vagrant/.vagrant/machines/worker-3/virtualbox/private_key
  StrictHostKeyChecking no
EOF

# 2. æµ‹è¯•
ssh k8s-control-1 'echo "è¿æ¥æˆåŠŸ!"'

# 3. ç„¶åå¯ä»¥ç”¨è¿™äº›åˆ«åæ“ä½œ
ssh k8s-control-1 'sudo whoami'
```

è¿™æ ·ä½ å°±å¯ä»¥ç»§ç»­éƒ¨ç½²K3säº†! ğŸš€

## æˆ–è€…ç›´æ¥ç”¨æ–¹æ¡ˆ1 (æœ€å¯é )

ä¸ä¾èµ–æ‰¾ç§é’¥,ç›´æ¥é€šè¿‡Vagrantæ·»åŠ ä½ çš„å…¬é’¥:

bash

```bash
# 1. ç¡®ä¿åœ¨Vagrantfileç›®å½•
cd /mnt/d/cai/k8s-cluster/vagrant/

# 2. å¤åˆ¶å…¬é’¥åˆ°control-1
cat /home/vagrant/.ssh/id_rsa.pub | vagrant ssh control-1 -c "mkdir -p ~/.ssh && chmod 700 ~/.ssh && cat >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys"

# 3. å¯¹å…¶ä»–èŠ‚ç‚¹ä¹ŸåšåŒæ ·æ“ä½œ
cat /home/vagrant/.ssh/id_rsa.pub | vagrant ssh worker-1 -c "mkdir -p ~/.ssh && chmod 700 ~/.ssh && cat >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys"
cat /home/vagrant/.ssh/id_rsa.pub | vagrant ssh worker-2 -c "mkdir -p ~/.ssh && chmod 700 ~/.ssh && cat >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys"
cat /home/vagrant/.ssh/id_rsa.pub | vagrant ssh worker-3 -c "mkdir -p ~/.ssh && chmod 700 ~/.ssh && cat >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys"

# 4. æµ‹è¯•SSHè¿æ¥
ssh vagrant@192.168.56.11 'echo "å…å¯†ç™»å½•æˆåŠŸ!"'
```

è¿™ä¸ªæ–¹æ¡ˆä¸éœ€è¦æ‰¾ç§é’¥æ–‡ä»¶,ç›´æ¥ç”¨Vagrantçš„è®¿é—®æƒé™æ¥æ·»åŠ ä½ çš„å…¬é’¥ã€‚

